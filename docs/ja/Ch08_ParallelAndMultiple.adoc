= 並列処理と多重処理の機能試験
:table-caption!:
:icons: font

== テストケース
テストケースクラス：jp.co.ntt.fw.macchinetta.batch.functionaltest.ch08.ParallelAndMultipleSpec

[cols="5,25,70a", options="headers"]
.テストケース一覧
|===
|項番
|テストケース
|確認事項

|1
|<<ParallelStep>>
|並列処理を行うのジョブの定義方法を確認する。

|2
|<<Partitioning>>
|多重処理を行うジョブの定義方法を確認する。

|===

== 試験項目一覧
各試験の項目一覧を示す。

:sectnums:
:leveloffset: -1

[[ParallelStep]]
=== 並列処理のテスト
並列処理を行うのジョブの定義方法を確認する。

[cols="5,20,25,25a,25a", options="header"]
.試験項目一覧
|===
|項番
|観点
|試験項目
|試験条件
|確認内容

|1
|正常系 +
同期実行型ジョブ
|最初から並列処理を行うのジョブを実行する
|
* 最初から並列処理を行うジョブを定義し、実行する
|並列処理が実行され、ジョブが正常に終了していること

* JobRepository
** BATCH_JOB_EXECUTION
*** ジョブが並列で実行され、ジョブが正常終了していること
* ジョブの出力結果
** 正常に処理が実施されたこと


|2
|異常系 +
同期実行型ジョブ
a|
* 最初から並列処理を行うジョブを実行する
** １つのステップがエラーを発生する
|
* 最初から並列処理を行うジョブを定義し、実行する
|並列処理が実行され、ジョブが異常終了していること

* JobRepository
** BATCH_JOB_EXECUTION
*** ジョブが並列で実行されていること
*** エラーが発生していないステップは正常終了していること
*** エラーが発生しているステップは異常終了していること
* ジョブの出力結果
** 正常終了したステップ
*** 正常に処理が実施されたこと
** 異常終了したステップ
*** 異常終了するまでのデータしか正常に処理されていないこと

|3
|正常系 +
同期実行型ジョブ
|途中から並列処理を行うのジョブを実行する
|
* 途中から並列処理を行うジョブを定義し、実行する
** 最初のステップは並列実行する前の共通処理とする
|並列処理が実行され、ジョブが正常に終了していること

* JobRepository
** BATCH_JOB_EXECUTION
*** ジョブが並列で実行され、ジョブが正常終了していること
* ジョブの出力結果
** 正常に処理が実施されたこと

|===

[[Partitioning]]
=== 多重処理のテスト
多重処理を行うのジョブの定義方法を確認する。

[cols="5,20,25,25a,25a", options="header"]
.試験項目一覧
|===
|項番
|観点
|試験項目
|試験条件
|確認内容

|1
|正常系 +
DB→DBのケース
|多重処理を行うジョブを実行する
|
* 多重処理を行うジョブを定義し、実行する
* Manager、WorkerはともにDBとする
** 部門別や月別のような分割方法でジョブを多重化する
* 分割数は不定とする
* 分割数 ＞ スレッド数

|多重処理が実行され、ジョブが正常に終了していること

* ログ
** 多重並列処理されていること
** 指定したスレッド数だけで処理が実行されたこと
* ジョブの出力結果
** 正常に処理が実施されたこと

|2
|正常系 +
DB→DBのケース
|多重処理を行うジョブを実行する
|
* 多重処理を行うジョブを定義し、実行する
* Manager、WorkerはともにDBとする
** 部門別や月別のような分割方法でジョブを多重化する
* 分割数は不定とする
* 分割数 ≦ スレッド数
|多重処理が実行され、ジョブが正常に終了していること

* ログ
** 多重並列処理されていること
** 指定した分割数のスレッドだけで処理が実行されたこと
* ジョブの出力結果
** 正常に処理が実施されたこと

|3
|正常系 +
DB→DBのケース
|多重処理を行うジョブを実行する
|
* 多重処理を行うジョブを定義し、実行する
* Manager、WorkerはともにDBとする
** 指定した分割数(grid-size)になる分割方法でジョブを多重化する
* grid-size ＝ 分割数
* grid-size ＞ スレッド数
|多重処理が実行され、ジョブが正常に終了していること

* ログ
** 多重並列処理されていること
** 指定したスレッド数だけで処理が実行されたこと
* ジョブの出力結果
** 正常に処理が実施されたこと

|4
|正常系 +
DB→DBのケース
|多重処理を行うジョブを実行する
|
* 多重処理を行うジョブを定義し、実行する
* Manager、WorkerはともにDBとする
** 指定した分割数(grid-size)になる分割方法でジョブを多重化する
* grid-size ＝ 分割数
* grid-size ≦ スレッド数
|多重処理が実行され、ジョブが正常に終了していること

* ログ
** 多重並列処理されていること
** 指定した分割数のスレッドだけで処理が実行されたこと
* ジョブの出力結果
** 正常に処理が実施されたこと

|5
|正常系 +
DB→複数ファイルのケース
|多重処理を行うジョブを実行する
|
* 多重処理を行うジョブを定義し、実行する
* ManagerはDB、Workerは複数のファイルとする
** 部門別や月別のような分割方法でジョブを多重化する
|多重処理が実行され、ジョブが正常に終了していること

* ログ
** 多重並列処理されていること
* ジョブの出力結果
** 正常に処理が実施されたこと

|6
|正常系 +
複数ファイル→ファイルごとのケース
|多重処理を行うジョブを実行する
|
* 多重処理を行うジョブを定義し、実行する
* Managerは複数ファイル、Workerは単一ファイルとする
** ファイル単位でジョブを多重化する
|多重処理が実行され、ジョブが正常に終了していること

* ログ
** ファイルごとにスレッドが割り当てられて処理されていること
* ジョブの出力結果
** 正常に処理が実施されたこと
|===
