= 処理の再実行の機能試験
:table-caption!:
:icons: font
:sectnums!:

== テストケース
テストケースクラス：jp.co.ntt.fw.macchinetta.batch.functionaltest.ch06.ReProcessingSpec

[cols="5,25a,70a", options="headers"]
.テストケース一覧
|===
|項番
|テストケース
|確認事項

|1
|リラン
|リランは通常のジョブ起動と同じになるため、試験対象外とする

|2
|<<restart>>
|
* 件数ベースのリスタート
* 状態ベースのリスタート
* 起動方法
** CommandLineJobRunnerによるリスタート
** JobOperatorによるリスタート
|===

== 試験項目一覧
各試験の項目一覧を示す。

:sectnums:
:leveloffset: -1

[[restart]]
=== リスタートのテスト
リスタートを確認する。

[cols="5,20,25a,25a,25a", options="header"]
.試験項目一覧
|===
|項番
|観点
|試験項目
|試験条件
|確認内容

|1
|正常系 +
同期型起動
|件数ベースでのリスタート
|
. チャンクモデルのジョブを実行する
** DBから不正なデータを読み込み、異常終了させる
. 不正なデータを修正する
. ジョブをリスタートする
** CommandLineJobRunnerによるリスタート
*** -restartオプションを利用

* 読み込んだデータをログ出力するようにする
* リスタートしたジョブであることがわかるログ出力を行う
|
* ログ出力により、中断箇所から再処理が始まっていること

|2
|正常系 +
同期型起動
|状態ベースでのリスタート
|
. チャンクモデルのジョブを実行する
** DBへ更新するジョブ。
*** 更新時に処理状態も一緒に更新する
** DBから不正なデータを読み込み、異常終了させる
** 未処理のデータだけを処理対象とする
. 不正なデータを修正する
. ジョブをリスタートする
** CommandLineJobRunnerによるリスタート
*** 初回起動時と同じパラメータで再実行（-restartオプションは利用しない）

* 読み込んだデータをログ出力するようにする
* リスタートしたジョブであることがわかるログ出力を行う
|
* ログ出力により、未処理のデータのみが再処理されたこと

|3
|正常系 +
同期型起動
|JobOperatorを使用したリスタート
|
* 項番1と同じジョブを使用する
* ジョブの起動とリスタートは、JobOperator#startと#restartを使用する
|
* 項番1と同じ

|===
